---
timezone: Asia/Shanghai
---

---

# Henry Wei

1. 自我介绍

大家好！我是一名拥有 10 年 Web 开发经验的技术经理和架构师，在多家公司中带领过团队，也主导过多个中大型项目的技术设计。写代码、解决问题、优化用户体验这些事，一直让我感到兴奋，因为我热爱创造并看到它产生实际影响。

最近，我对 Web3 领域产生了浓厚的兴趣。这个充满未知和可能性的领域让我很兴奋，也让我重新找回了刚开始学习编程时的那种好奇心。我希望未来能在这方面做一些尝试，深入探索区块链和去中心化的世界。

生活中，我喜欢和不同文化、背景的人交流，总能从他们的故事中获得灵感。我相信，每一次真诚的交流都是一次成长的机会。

我是个对未来充满信心的人，无论是面对技术还是生活中的挑战，我始终相信，只要脚踏实地，总会迎来让人惊喜的结果。期待和更多志同道合的人一起交流，共同学习！

2. 你认为你会完成本次残酷学习吗？

很高兴可以参加这次共建学习，我相信自己会坚持到第21天，加油吧！

## Notes

<!-- Content_START -->

### 2024.12.10

#### Arbitrum 入门

#### 概念

Arbitrum 是以太坊生态中比较知名的二层（Layer 2）扩容解决方案之一。其设计目标是通过`Optimistic Rollup`，在保持以太坊安全性的同时大幅提升交易吞吐量并降低交易费用。

#### 使命

1. 扩容以太坊生态

  以太坊面临着交易费用高昂、网络拥堵的问题。Arbitrum 的使命是通过在 Layer 2 执行大量计算，将结果定期提交到以太坊主链，以此缓解主网的负载压力，从而实现更高的交易吞吐量和更低的 Gas 成本。

1. 保持去中心化与安全性

  Arbitrum 以以太坊主网为安全基础层，确保 Layer 2 的状态最终性依托以太坊的共识与可信度。同时，通过优化的欺诈证明机制，Arbitrum 不需要引入额外的高信任度中介，从而保持网络的去中心化特性。

1. 增强开发者与用户体验

  Arbitrum 兼容EVM，开发者可以使用已有工具链、语言和框架，无需重构智能合约。同时，较低的交易费用和更快的结算速度，为终端用户提供更友好的交互体验，促进 DeFi、NFT、游戏、社交等 Web3 应用的落地与普及

##### 特点

- Optimistic Rollup 架构

  Arbitrum 基于 Optimistic Rollup 技术，将绝大部分交易计算和状态更新在链下完成，然后将最终结果（`状态根`）和`压缩后的交易数据`定期提交至以太坊主网，从而大幅降低链上负载。

- EVM 高兼容性：

  基于以太坊 Geth（Go-Ethereum）的代码库进行改造，将 EVM 执行引擎编译为 WebAssembly（WASM）， 开发者可无缝迁移现有合约和工具链，直接利用以太坊成熟的核心代码和生态。

- 高吞吐量与低成本：

  相较直接在以太坊主网上执行交易，Arbitrum 能够以显著更低的 Gas 费用处理更多笔交易。同时，因大部分计算在 Layer 2 侧完成，其吞吐量也得以提升。

- 欺诈证明与挑战机制

  Arbitrum 默认假设提交的状态更新是正确的，但任意验证者都可以在特定时间窗口内对可疑结果发起挑战。一旦挑战证明结果错误，作恶者的保证金会被没收，从而经济上激励所有参与者保持诚实。

- DAO 治理

  Arbitrum 通过治理代币 ARB 以及 DAO 机制，将网络升级、参数调整和资金使用的权力下放给社区，让社区成员对项目的未来发展有更直接的参与和决策权

##### 原理

1. Optimistic Rollup 工作流程

- 链下执行：绝大多数交易在 Arbitrum 的链下环境中执行，得到新的状态根

- 批量提交：将汇总后的交易数据和状态承诺（State Root）周期性写入以太坊主链。

- 乐观假设与纠错：主链对提交的数据默认视为正确，仅在出现质疑（挑战）时才要求提供欺诈证明，进而在链上运行最小范围的验证以判定正确与否。

2.欺诈证明机制（Fraud Proof）：

  当有验证者认为提交的状态更新无效时，可在指定的挑战期内发起欺诈证明。挑战过程采用`交互式多轮协议`，通过二分查找定位执行路径中的争议点。当找到确切的欺诈步骤后，链上合约会裁定胜负，并惩罚作恶者。

3.状态与数据可用性

  Arbitrum 利用以太坊链作为“数据可用性层”。所有 Rollup 所需的原始交易数据均在主网存储（以压缩方式），确保即使在挑战时，数据依旧可被取用和验证，不会因数据不可用而造成安全隐患

#### 技术架构

Arbitrum 技术架构基于`Optimistic Rollup`的理念，在以太坊主网上提供一种`高效、低成本并保持安全性`的二层（Layer 2）扩容方案。其核心思想是将绝大部分计算与状态执行移至`链下`，并只将最终经过压缩、汇总的状态根和交易数据`定期提交`到以太坊主链上，从而显著提升吞吐量并降低交易费用

##### 核心组成部分

1. Optimistic Rollup 框架

  Arbitrum 属于 Optimistic Rollup 方案，意味着它对交易的有效性采取“乐观”假设

- 默认有效性
  
  链上（L1）对提交上来的执行结果默认视为有效，不进行逐笔验证，从而避免在主链上大量消耗算力和高额费用。

- 挑战和纠错机制（Fraud Proof）

  如果有人认为提交的执行结果有问题，可在指定挑战期内发起“欺诈证明”挑战。通过在链上运行一套交互式的验证游戏，二者以二分查找的方式逐步缩小争议范围，最终由智能合约裁定谁对谁错。
  一旦挑战成功，作恶者的保证金将被没收，确保网络有充足动力维持诚实性。

2.Arbitrum 虚拟机（AVM）

  AVM 是 Arbitrum Layer 2 的执行环境，对 EVM 有高度的兼容性。这意味着智能合约开发者可以使用与以太坊相同的工具链（Solidity、Vyper 等）和开发框架（Truffle、Hardhat 等）进行部署和测试，无需大幅修改合约代码

- EVM 兼容性

  AVM 在底层指令集、Gas 计量方式和存储模型上高度兼容 EVM，使已有的合约和开发工具可轻松迁移。

- ArbOS（Arbitrum Operating System）

  AVM 顶层有一层名为 ArbOS 的系统软件，负责实现交易处理、Gas 计量、跨链消息处理和状态管理等功能，为智能合约提供更加高效和灵活的运行环境。

3.链下合约执行与链上数据提交
  
  在 Arbitrum 侧链上，交易会由验证者（Validators）或聚合器（Aggregators）来执行并得出新状态。随后，这些新状态根（State Root）和必要的交易数据以打包和压缩的形式提交到以太坊主链上。

- 状态承诺（State Commitment）

  将计算后的状态根定期上链，以太坊主链保存着这些状态的加密承诺。

- 数据可用性（Data Availability）

  Arbitrum 最初依托以太坊区块链存储 Rollup 的输入数据。确保在发生争议时，数据仍然可供验证者获得，从而进行欺诈证明。

4.验证者与挑战者角色

  Arbitrum 网络中的节点（validators）承担着监督和验证的角色。一些节点会提交状态更新，如果有节点认为更新无效，就会发起挑战。这个多方博弈关系确保了只有正确的状态才能在主链上最终定稿。

5.分步式欺诈证明

  在欺诈证明环节，Arbitrum 采用`交互式的多轮仲裁`方案，而非一次性提交所有计算步骤。在挑战中，双方通过二分法将执行轨迹逐步分解，最终锁定争议的具体指令，从而确定谁在说谎。这种多轮交互大大降低了在主链上进行整段执行验证的成本

##### 优势

- 高吞吐量与低费用
  
  通过将计算大部分移至链下执行，并在链上只提交最终结果和压缩数据，Arbitrum 显著降低了 Gas 成本并提高交易处理速度。

- 对以太坊的强安全依赖
  
  Arbitrum 在安全性上依托以太坊主网，若出现恶意状态提交，挑战机制确保最终状态的正确性。

- 易于迁移的开发生态

  对 EVM 高兼容性使智能合约开发者和现有以太坊应用可快速部署到 Arbitrum，无需从头学习新虚拟机语言或指令集

##### 总结

Arbitrum 的技术架构以 Optimistic Rollup 为基础，通过交互式欺诈证明、EVM 兼容的虚拟机环境和高效的数据压缩与上链机制，实现了在确保安全性的同时提升吞吐量、降低费用的目标。该架构为以太坊生态提供了一个可扩容、经济高效且易用的 Layer 2 解决方案，对 DeFi、NFT、游戏和各类 Web3 应用的规模化发展起到了关键作用

### 2024.12.11

#### 什么是Rollup

Rollup 是一种二层（Layer 2）扩容方案，通过将大量的交易数据和执行从主链（如以太坊）迁移到链下处理，并在主链上定期存储压缩后的数据和状态承诺。

- **核心思想**
  
  在L2执行大量交易，仅将执行后的结果和必要的压缩数据提交到主链，从而减少主链的计算和存储负担，提升网络吞吐量、降低交易费用。

- **数据可用性保证**
  
  Rollup 要求所有用于重新计算状态的原始数据最终可在主链上找到（以压缩形式存储），确保如果需要验证者对二层状态进行独立验证时，数据是可用的。

在 Rollup 的大框架下，根据验证交易有效性的方式不同，大致可以分为两类主流方案：`Optimistic Rollup` 与 `ZK Rollup`

##### Optimistic Rollups

Optimistic Rollups，对提交的结果采取一种“乐观”假设：默认提交的状态更新都是正确的，不在提交时立即强制验证。

- **工作原理**
  
  L2执行后，聚合器（Sequencer）将打包好的交易和新状态根提交到主链上，主链默认将其视为有效状态。

- **挑战期与欺诈证明（Fraud Proof）**

  因为是“乐观”假设，所以允许网络参与者在一个时间窗口内（挑战期）对可疑的交易结果发起挑战，提交欺诈证明。

  通过在链上与提交方交互验证执行步骤（交互式纠纷解决协议），最终发现提交方是否作恶。一旦作恶被确认，其保证金被没收，并恢复正确状态。

- **优点**

  - 无需在每次提交时使用昂贵的零知识证明。
  - 对以太坊的开发环境和 EVM 兼容度更高，迁移成本低。

- **缺点**

  - 需要挑战期，意味着提款等操作在最终确定性上会略有延迟。
  - 需要经济激励与保证金机制来维持诚实性

##### Zk Rollups

ZK Rollups（Zero-Knowledge Rollups），利用零知识证明（ZKP）技术来保证二层交易的有效性。

- **工作原理**

  在二层链下处理大量交易后，由证明者（Prover）生成一份零知识证明，证明这些交易的执行结果是正确的。然后将交易数据与该证明一并提交到主链上。

- **验证方式**

  主链上的合约通过验证零知识证明的有效性即可保证这批交易结果的正确性，而无需逐笔重复计算交易。这种验证过程高效且无需信任第三方。

- **优点**

  - 无需“挑战期”或额外的争议解决过程，因为零知识证明在提交时就已确保结果正确性。
  - 安全性高且确认迅速。

- **缺点**

  - 生成 ZK 证明的计算过程复杂且可能比较昂贵，但技术在不断进步，使得证明生成越来越高效。
  - 开发工具与对 EVM 的完全兼容性仍在完善（已有很多进展，例如ZK-EVM）
  
#### Arbitrum 与 Optimistic Rollup 的关系

Arbitrum 是目前最知名、应用最广泛的基于 Optimistic Rollup 技术的二层解决方案之一。

- Arbitrum 的特点

  - Optimistic 架构：和其它 Optimistic Rollup 一样，默认假设提交结果正确，仅在质疑出现时运行欺诈证明。
  - EVM 高度兼容：，使用 WebAssembly（WASM） 来执行现有以太坊 Geth（Go-Ethereum）代码的修改版本，从而达成接近 1:1 的 EVM 兼容
  - 交互式欺诈证明：Arbitrum 使用一个分步的（Binary Search）仲裁机制来快速定位错误指令，降低在主链上完整重放争议交易的成本。
  - 生态丰富度：因为其易用性和对 EVM 的兼容，Arbitrum 上已经吸引了大量 DeFi、NFT 和游戏类应用。

### 2024.12.12

#### 欺诈证明

欺诈证明是乐观汇总等扩展方案的关键安全组件，通过引入互动式的挑战和经济激励/惩罚手段，实现了在降低链上计算负担的前提下，仍能确保链下执行结果的正确性和安全性。

Arbitrum中的欺诈证明通过`交互式`验证游戏和经济激励，在无需每个交易都在L1链上重放验证的前提下，保证了系统最终状态的一致性和正确性。一旦有参与者提交可疑的状态更新，其他人可以对其发起挑战，并在链上使用`智能合约`来协调和裁决这场“缩小范围寻找错误点”的博弈，从而达到确保网络安全和正确运作的目的

##### 核心要点

###### 1.乐观执行假设

在没有挑战的情况下，系统默认接受断言者发布的状态为真，并在经过一个挑战期后将该状态确定化。这样提高系统性能，在绝大多数诚实场景中，区块可以快速定稿，无需额外验证。

###### 2.提出挑战（Fraud Proof）

如果有人认为断言有误，可以发起欺诈证明的挑战。挑战是有经济成本的：挑战者和断言者都要在系统中抵押一定的保证金（Bond）。

- 发起欺诈证明的条件通常是在`挑战期`（Challenge Period）内进行的。
- 如果挑战者坐实了断言中的问题，他们将获得奖励，而被挑战的一方会受到惩罚（通常是没收其押金）。

###### 3.交互式验证（Interactive Verification）

Arbitrum中欺诈证明的过程采用了“交互式”验证游戏，断言者与挑战者通过一系列步骤，将有争议的计算范围逐步“二分”，类似于使用二分查找法（binary search）来定位错误产生的精确点：

- 初始的争议范围是断言者所提交的整段计算。
- 挑战者要求断言者把这段计算分割成更小的区间，并逐步缩小有问题的区间。
- 经过多次交互后，双方会最终锁定在一个单步执行上：若此步骤的执行结果与预期的L1逻辑不符，即可证明断言存在欺诈。

###### 4.时间限制与反应窗口

整个挑战过程有严格的时间限制。如果在某个步骤里的一方没有在规定时间内响应对方的要求或指令，该方将自动认输。这确保了争议不会无限期拖延。

###### 5.最终结果与激励机制

- 如果挑战成功（证明被挑战的断言中确实存在错误），断言者会被惩罚（押金被没收），挑战者获得奖励。
- 如果挑战失败（无法证明断言有误），则说明断言正确无误，挑战者将受到惩罚，断言者的状态断言则被确认为合法并最终定稿。

###### 6.经济与安全性背书

欺诈证明机制利用`经济刺激和惩罚`使得诚实行为具有积极收益而欺诈行为代价高昂。因为发布错误断言的节点可能会失去押金，所以没有经济理性节点愿意轻易为之。这就确保在没有持续错误断言的情况下，Arbitrum的状态更新是高效且大概率正确的。

##### 交互式欺诈证明

交互式欺诈证明是欺诈证明的一种具体实现形式，它通过一系列双方交互来确定断言是否存在错误，而非一次性提交全部证明。其思想类似于二分查找：

1.初始争议范围

挑战从一个较大的有争议计算范围（如整段交易执行）开始。

2.逐步缩小范围

- 挑战者与断言者在智能合约（如“Challenge Manager”）的协调下反复交互。
- 每次交互中，挑战者要求将争议的计算过程分割成更小的区间，从而不断缩小错误可能出现的范围。
  
3.最终定位错误点

经过多轮分割和回应后，最终会锁定在某个具体的单步执行。如果该单步执行与底层规则不一致，即可证明断言者有欺诈行为。

4.时间限制与经济保证

在交互过程中，两方都必须在规定时间内回应，否则将自动判定为失败。此外，双方在参与之前需缴纳保证金，以确保只有在有充分把握的情况下才会发起挑战或坚持自己的断言，从而减少无端纠纷

###### 优点

- 链上负载更低

通过二分查找式的分步验证过程，仅在最终必要的执行步骤上提交证据，这大大减少了需要在链上进行的计算和数据存储量。链上不需要一次性处理所有中间状态和执行步骤，从而降低了Gas消耗和链上拥堵。

- 适应复杂计算

对于较长或复杂的执行过程，交互式验证机制允许在多轮交互中逐步缩小问题范围，不必一次提交庞大的完整执行证明，提升了处理复杂合约计算的可行性。

- 较灵活的博弈机制

通过多轮交互，挑战者和断言者都必须在特定时间窗口内回应。在经济和策略层面提供了更灵活的博弈空间，有利于排除轻率挑战和欺诈性断言

###### 缺点

- 协议复杂度较高

需要多个来回交互、明确的时间限制和更多逻辑判断，使得合约设计、实现和审计变得更加复杂。

- 验证时间较长

因为需要多轮交互，每一轮之间还需要等待时间，整体挑战过程可能比非交互式证明更长，影响最终状态的确定性速度。

- 用户体验与参与成本
  
双方参与者（断言者、挑战者）需要持续关注与回应，较为繁琐。在用户体验和参与成本方面稍有不利。
<!-- Content_END -->
